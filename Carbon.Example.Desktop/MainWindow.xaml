<Window x:Class="Carbon.Example.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:main="clr-namespace:Carbon.Example.Desktop"
        xmlns:model="clr-namespace:Carbon.Example.Desktop.Model"
        x:ClassModifier="internal"
        mc:Ignorable="d"
        Title="Example Application"
        WindowStartupLocation="CenterScreen"
        Height="750" Width="900"
        MinHeight="750" MinWidth="900">

    <Window.DataContext>
        <model:MainController/>
    </Window.DataContext>

    <Window.CommandBindings>
        <CommandBinding Command="ApplicationCommands.Help" Executed="HelpExecute" CanExecute="HelpCanExecute"/>
        <CommandBinding Command="ApplicationCommands.Close" CanExecute="CloseCanExecute" Executed="CloseExecute"/>
        <CommandBinding Command="main:MainCommands.GetLicence" CanExecute="GetLicenceCanExecute" Executed="GetLicenceExecute"/>
        <CommandBinding Command="main:MainCommands.CloseLicence" CanExecute="CloseLicenceCanExecute" Executed="CloseLicenceExecute"/>
        <CommandBinding Command="main:MainCommands.CloseAlert" CanExecute="CloseAlertCanExecute" Executed="CloseAlertExecute"/>
        <CommandBinding Command="main:MainCommands.GenerateReport" CanExecute="GenerateReportCanExecute" Executed="GenerateReportExecute"/>
        <CommandBinding Command="main:MainCommands.NewReport" CanExecute="NewReportCanExecute" Executed="NewReportExecute"/>
    </Window.CommandBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Menu Padding="2,2,2,3">
            <MenuItem Header="_File">
                <MenuItem Header="_Get Licence" Command="main:MainCommands.GetLicence"/>
                <MenuItem Header="_Close Licence" Command="main:MainCommands.CloseLicence"/>
                <Separator/>
                <MenuItem Header="Exit" Command="ApplicationCommands.Close"/>
            </MenuItem>
            <MenuItem Header="_Help">
                <MenuItem Header="_GitHub" Command="ApplicationCommands.Help"/>
            </MenuItem>
        </Menu>

        <Grid Grid.Row="1">
            <main:AuthenticateControl Grid.Row="1" Visibility="{Binding Licence,Converter={StaticResource MainVerter},ConverterParameter=NoneVisible}"/>
            <main:CarbonControl Grid.Row="1" Visibility="{Binding Licence,Converter={StaticResource MainVerter},ConverterParameter=SomeVisible}"/>
            <Border Background="DarkRed" MaxWidth="550" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="10" Padding="10" CornerRadius="8" Visibility="{Binding AlertTitle,Converter={StaticResource MainVerter},ConverterParameter=SomeVisible}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Image Source="Images/AppError.png" Width="48" Margin="0,0,10,0"/>
                    <StackPanel Grid.Column="1" Orientation="Vertical">
                        <TextBlock TextWrapping="Wrap" Foreground="MistyRose" FontSize="16" FontWeight="Bold" Text="{Binding AlertTitle}"/>
                        <TextBlock TextWrapping="Wrap" Foreground="Snow" Text="{Binding AlertDetail}"/>
                    </StackPanel>
                    <Button Grid.Column="2" Content="OK" VerticalAlignment="Center" Padding="12,4" Margin="10,0,0,0" Command="main:MainCommands.CloseAlert"/>
                </Grid>
            </Border>
        </Grid>

        <StatusBar Grid.Row="2" Background="WhiteSmoke">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            <StatusBarItem VerticalAlignment="Center">
                <TextBlock Margin="4,0,0,0">
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource MainMultiVerter}" ConverterParameter="StatusMessage">
                            <Binding Path="Provider"/>
                            <Binding Path="Engine"/>
                            <Binding Path="OpenCustomerNode"/>
                            <Binding Path="OpenJobNode"/>
                            <Binding Path="OpenVartreeName"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </StatusBarItem>
            <StatusBarItem Grid.Column="1" VerticalAlignment="Center">
                <Border Background="Yellow" Visibility="{Binding BusyMessage,Converter={StaticResource MainVerter},ConverterParameter=SomeVisible}" Padding="6,1,6,2">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="Images/Busy16.png" Width="16" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding BusyMessage}"/>
                    </StackPanel>
                </Border>
            </StatusBarItem>
            <StatusBarItem Grid.Column="2" VerticalAlignment="Center">
                <Slider Minimum="9" Maximum="20" SmallChange="1" LargeChange="1" Width="90" VerticalAlignment="Center" Value="{Binding AppFontSize,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
            </StatusBarItem>
            <StatusBarItem Grid.Column="3" VerticalAlignment="Center">
                <TextBlock Text="{Binding StatusTime}" Margin="10,0,4,0"/>
            </StatusBarItem>
        </StatusBar>


    </Grid>
</Window>
